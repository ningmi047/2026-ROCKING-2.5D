<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
   <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <script>
      // ==========================================================
      // 1. 去背 Shader (維持不變)
      // ==========================================================
      AFRAME.registerShader('chroma-key', {
        schema: {
          src: {type: 'map', is: 'uniform'},
          color: {type: 'vec3', default: {x: 0.0, y: 0.0, z: 0.0}, is: 'uniform'},
          threshold: {type: 'number', is: 'uniform', default: 0.1}
        },
        vertexShader: `
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }
        `,
        fragmentShader: `
          uniform sampler2D src;
          uniform vec3 color;
          uniform float threshold;
          uniform float smoothness; // 雖然這裡沒定義 smoothness 但舊版能跑就不動它
          varying vec2 vUv;
          void main() {
            vec4 tex = texture2D(src, vUv);
            float distance = length(tex.rgb - color);
            float alpha = smoothstep(0.0, threshold, distance);
            gl_FragColor = vec4(tex.rgb, alpha);
          }
        `
      });

      // ==========================================================
      // 2. 影片同步糾察隊 (維持不變)
      // ==========================================================
      AFRAME.registerComponent('video-sync-monitor', {
        tick: function () {
          const master = document.querySelector('#vid-bg');
          const slaves = [
            document.querySelector('#vid-horse'),


